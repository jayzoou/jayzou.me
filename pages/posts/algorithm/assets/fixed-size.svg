<svg viewBox="0 0 1200 700" xmlns="http://www.w3.org/2000/svg">
  <defs>
    <style>
      @keyframes moveWindow {
        0%, 16% { transform: translateX(0); }
        20%, 36% { transform: translateX(100px); }
        40%, 56% { transform: translateX(200px); }
        60%, 76% { transform: translateX(300px); }
        80%, 96% { transform: translateX(400px); }
        100% { transform: translateX(500px); }
      }
      @keyframes moveRemoveArrow {
        0%, 16% { transform: translateX(0); }
        20%, 36% { transform: translateX(100px); }
        40%, 56% { transform: translateX(200px); }
        60%, 76% { transform: translateX(300px); }
        80%, 96% { transform: translateX(400px); }
        100% { transform: translateX(500px); }
      }
      @keyframes moveAddArrow {
        0%, 16% { transform: translateX(400px); }
        20%, 36% { transform: translateX(500px); }
        40%, 56% { transform: translateX(600px); }
        60%, 76% { transform: translateX(700px); }
        80%, 96% { transform: translateX(800px); }
        100% { transform: translateX(900px); }
      }
      @keyframes highlight0 {
        0%, 14% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        16%, 18% { fill: #ffccbc; stroke: #ff5722; stroke-width: 4; }
        20%, 100% { fill: #e0e0e0; stroke: #9e9e9e; stroke-width: 2; }
      }
      @keyframes highlight1 {
        0%, 14% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        16%, 34% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        36%, 38% { fill: #ffccbc; stroke: #ff5722; stroke-width: 4; }
        40%, 100% { fill: #e0e0e0; stroke: #9e9e9e; stroke-width: 2; }
      }
      @keyframes highlight2 {
        0%, 14% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        16%, 54% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        56%, 58% { fill: #ffccbc; stroke: #ff5722; stroke-width: 4; }
        60%, 100% { fill: #e0e0e0; stroke: #9e9e9e; stroke-width: 2; }
      }
      @keyframes highlight3 {
        0%, 14% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        16%, 74% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        76%, 78% { fill: #ffccbc; stroke: #ff5722; stroke-width: 4; }
        80%, 100% { fill: #e0e0e0; stroke: #9e9e9e; stroke-width: 2; }
      }
      @keyframes highlight4 {
        0%, 18% { fill: #ffffff; stroke: #2196f3; stroke-width: 3; }
        20%, 34% { fill: #fff9c4; stroke: #fbc02d; stroke-width: 4; }
        36%, 94% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
        96%, 98% { fill: #ffccbc; stroke: #ff5722; stroke-width: 4; }
        100% { fill: #e0e0e0; stroke: #9e9e9e; stroke-width: 2; }
      }
      @keyframes highlight5 {
        0%, 38% { fill: #ffffff; stroke: #2196f3; stroke-width: 3; }
        40%, 54% { fill: #fff9c4; stroke: #fbc02d; stroke-width: 4; }
        56%, 100% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
      }
      @keyframes highlight6 {
        0%, 58% { fill: #ffffff; stroke: #2196f3; stroke-width: 3; }
        60%, 74% { fill: #fff9c4; stroke: #fbc02d; stroke-width: 4; }
        76%, 100% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
      }
      @keyframes highlight7 {
        0%, 78% { fill: #ffffff; stroke: #2196f3; stroke-width: 3; }
        80%, 94% { fill: #fff9c4; stroke: #fbc02d; stroke-width: 4; }
        96%, 100% { fill: #c8e6c9; stroke: #4caf50; stroke-width: 3; }
      }
      @keyframes highlight8 {
        0%, 98% { fill: #ffffff; stroke: #2196f3; stroke-width: 3; }
        100% { fill: #fff9c4; stroke: #fbc02d; stroke-width: 4; }
      }
      @keyframes showSum0 {
        0%, 16% { opacity: 1; }
        17%, 100% { opacity: 0; }
      }
      @keyframes showSum1 {
        0%, 19% { opacity: 0; }
        20%, 36% { opacity: 1; }
        37%, 100% { opacity: 0; }
      }
      @keyframes showSum2 {
        0%, 39% { opacity: 0; }
        40%, 56% { opacity: 1; }
        57%, 100% { opacity: 0; }
      }
      @keyframes showSum3 {
        0%, 59% { opacity: 0; }
        60%, 76% { opacity: 1; }
        77%, 100% { opacity: 0; }
      }
      @keyframes showSum4 {
        0%, 79% { opacity: 0; }
        80%, 96% { opacity: 1; }
        97%, 100% { opacity: 0; }
      }
      @keyframes showSum5 {
        0%, 99% { opacity: 0; }
        100% { opacity: 1; }
      }
      @keyframes fadeInOut0 {
        0%, 16% { opacity: 1; }
        18%, 100% { opacity: 0; }
      }
      @keyframes fadeInOut1 {
        0%, 18% { opacity: 0; }
        20%, 36% { opacity: 1; }
        38%, 100% { opacity: 0; }
      }
      @keyframes fadeInOut2 {
        0%, 38% { opacity: 0; }
        40%, 56% { opacity: 1; }
        58%, 100% { opacity: 0; }
      }
      @keyframes fadeInOut3 {
        0%, 58% { opacity: 0; }
        60%, 76% { opacity: 1; }
        78%, 100% { opacity: 0; }
      }
      @keyframes fadeInOut4 {
        0%, 78% { opacity: 0; }
        80%, 96% { opacity: 1; }
        98%, 100% { opacity: 0; }
      }
      @keyframes fadeInOut5 {
        0%, 98% { opacity: 0; }
        100% { opacity: 1; }
      }
      @keyframes maxUpdate {
        0%, 36% { opacity: 1; transform: scale(1); }
        38%, 40% { opacity: 1; transform: scale(1.15); }
        42%, 100% { opacity: 0.4; transform: scale(1); }
      }
      @keyframes showRemoveArrow {
        0%, 18% { opacity: 0; }
        20%, 36% { opacity: 1; }
        38%, 38% { opacity: 0; }
        40%, 56% { opacity: 1; }
        58%, 58% { opacity: 0; }
        60%, 76% { opacity: 1; }
        78%, 78% { opacity: 0; }
        80%, 96% { opacity: 1; }
        98%, 98% { opacity: 0; }
        100% { opacity: 1; }
      }
      @keyframes showAddArrow {
        0%, 18% { opacity: 0; }
        20%, 36% { opacity: 1; }
        38%, 38% { opacity: 0; }
        40%, 56% { opacity: 1; }
        58%, 58% { opacity: 0; }
        60%, 76% { opacity: 1; }
        78%, 78% { opacity: 0; }
        80%, 96% { opacity: 1; }
        98%, 100% { opacity: 0; }
      }
      .array-box {
        filter: drop-shadow(0 2px 4px rgba(0,0,0,0.1));
        transition: all 0.3s ease;
      }
      .box-0 { animation: highlight0 12s ease-in-out infinite; }
      .box-1 { animation: highlight1 12s ease-in-out infinite; }
      .box-2 { animation: highlight2 12s ease-in-out infinite; }
      .box-3 { animation: highlight3 12s ease-in-out infinite; }
      .box-4 { animation: highlight4 12s ease-in-out infinite; }
      .box-5 { animation: highlight5 12s ease-in-out infinite; }
      .box-6 { animation: highlight6 12s ease-in-out infinite; }
      .box-7 { animation: highlight7 12s ease-in-out infinite; }
      .box-8 { animation: highlight8 12s ease-in-out infinite; }
      .array-text {
        font-family: 'Courier New', monospace;
        font-size: 28px;
        font-weight: bold;
        fill: #1565c0;
        text-anchor: middle;
        dominant-baseline: middle;
      }
      .window-area {
        fill: #bbdefb;
        opacity: 0.5;
        stroke: #2196f3;
        stroke-width: 3;
        stroke-dasharray: 5,5;
        animation: moveWindow 12s ease-in-out infinite;
      }
      .window-label {
        font-family: 'Arial', sans-serif;
        font-size: 16px;
        font-weight: bold;
        fill: #1565c0;
        text-anchor: middle;
        animation: moveWindow 12s ease-in-out infinite;
      }
      .step-text {
        font-family: 'Arial', sans-serif;
        font-size: 17px;
        font-weight: 600;
        text-anchor: start;
        animation-duration: 12s;
        animation-iteration-count: infinite;
      }
      .step0 { animation-name: fadeInOut0; fill: #1976d2; }
      .step1 { animation-name: fadeInOut1; fill: #4caf50; }
      .step2 { animation-name: fadeInOut2; fill: #4caf50; }
      .step3 { animation-name: fadeInOut3; fill: #4caf50; }
      .step4 { animation-name: fadeInOut4; fill: #4caf50; }
      .step5 { animation-name: fadeInOut5; fill: #4caf50; }
      .sum-value {
        font-family: 'Courier New', monospace;
        font-size: 32px;
        fill: #e65100;
        font-weight: bold;
        text-anchor: middle;
        animation-duration: 12s;
        animation-iteration-count: infinite;
        animation-fill-mode: both;
      }
      .sum0 { animation-name: showSum0; }
      .sum1 { animation-name: showSum1; }
      .sum2 { animation-name: showSum2; }
      .sum3 { animation-name: showSum3; }
      .sum4 { animation-name: showSum4; }
      .sum5 { animation-name: showSum5; }
      .title {
        font-family: 'Arial', sans-serif;
        font-size: 32px;
        fill: #1565c0;
        font-weight: bold;
        text-anchor: middle;
      }
      .subtitle {
        font-family: 'Arial', sans-serif;
        font-size: 16px;
        fill: #757575;
        text-anchor: middle;
      }
      .code-text {
        font-family: 'Courier New', monospace;
        font-size: 12px;
        fill: #424242;
      }
      .counter {
        font-family: 'Arial', sans-serif;
        font-size: 14px;
        fill: #666;
        text-anchor: middle;
      }
      .info-box {
        fill: #e3f2fd;
        stroke: #2196f3;
        stroke-width: 2;
        rx: 8;
      }
      .legend-box {
        fill: #f5f5f5;
        stroke: #e0e0e0;
        stroke-width: 2;
        rx: 6;
      }
      .legend-text {
        font-family: 'Arial', sans-serif;
        font-size: 13px;
        fill: #424242;
      }
      .sum-box {
        fill: #fff3e0;
        stroke: #ff9800;
        stroke-width: 2;
        rx: 6;
      }
      .sum-text {
        font-family: 'Courier New', monospace;
        font-size: 18px;
        fill: #e65100;
        font-weight: 600;
        text-anchor: middle;
      }
      .max-box {
        fill: #e8f5e9;
        stroke: #4caf50;
        stroke-width: 3;
        rx: 8;
        animation: maxUpdate 12s ease-in-out infinite;
      }
      .max-text {
        font-family: 'Arial', sans-serif;
        font-size: 24px;
        fill: #2e7d32;
        font-weight: bold;
        text-anchor: middle;
      }
      .remove-arrow-group {
        animation: moveRemoveArrow 12s ease-in-out infinite;
      }
      .remove-arrow {
        animation: showRemoveArrow 12s ease-in-out infinite;
        fill: none;
        stroke: #ff5252;
        stroke-width: 3;
        marker-end: url(#arrowhead-remove);
      }
      .remove-label {
        animation: showRemoveArrow 12s ease-in-out infinite;
      }
      .add-arrow-group {
        animation: moveAddArrow 12s ease-in-out infinite;
      }
      .add-arrow {
        animation: showAddArrow 12s ease-in-out infinite;
        fill: none;
        stroke: #4caf50;
        stroke-width: 3;
        marker-end: url(#arrowhead-add);
      }
      .add-label {
        animation: showAddArrow 12s ease-in-out infinite;
      }
    </style>
    <marker id="arrowhead-remove" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#ff5252" />
    </marker>
    <marker id="arrowhead-add" markerWidth="10" markerHeight="10" refX="9" refY="3" orient="auto">
      <polygon points="0 0, 10 3, 0 6" fill="#4caf50" />
    </marker>
  </defs>
  
  <!-- 背景渐变 -->
  <defs>
    <linearGradient id="bgGradient" x1="0%" y1="0%" x2="0%" y2="100%">
      <stop offset="0%" style="stop-color:#e8eaf6;stop-opacity:1" />
      <stop offset="100%" style="stop-color:#ffffff;stop-opacity:1" />
    </linearGradient>
  </defs>
  <rect width="1200" height="700" fill="url(#bgGradient)"/>
  
  <!-- 标题区域 -->
  <text x="600" y="40" class="title">固定大小滑动窗口 - 最大子数组和</text>
  <text x="600" y="65" class="subtitle">Fixed-Size Sliding Window - Maximum Subarray Sum</text>
  
  <!-- 测试用例信息 -->
  <rect x="250" y="85" width="700" height="30" class="info-box"/>
  <text x="600" y="105" class="subtitle" style="font-weight: 600; fill: #1565c0;">
    数组: [1, 4, 2, 10, 23, 3, 1, 0, 20]  窗口大小 k = 4  最大和 = 39
  </text>
  
  <!-- 数组索引 -->
  <text x="160" y="155" class="counter">0</text>
  <text x="260" y="155" class="counter">1</text>
  <text x="360" y="155" class="counter">2</text>
  <text x="460" y="155" class="counter">3</text>
  <text x="560" y="155" class="counter">4</text>
  <text x="660" y="155" class="counter">5</text>
  <text x="760" y="155" class="counter">6</text>
  <text x="860" y="155" class="counter">7</text>
  <text x="960" y="155" class="counter">8</text>
  
  <!-- 滑动窗口区域 -->
  <rect x="120" y="170" width="400" height="80" class="window-area" rx="8"/>
  <text x="320" y="140" class="window-label">窗口 (k=4)</text>
  
  <!-- 数组元素 (间距100px) -->
  <g id="array">
    <rect x="120" y="170" width="80" height="80" rx="8" class="array-box box-0"/>
    <text x="160" y="210" class="array-text">1</text>
    
    <rect x="220" y="170" width="80" height="80" rx="8" class="array-box box-1"/>
    <text x="260" y="210" class="array-text">4</text>
    
    <rect x="320" y="170" width="80" height="80" rx="8" class="array-box box-2"/>
    <text x="360" y="210" class="array-text">2</text>
    
    <rect x="420" y="170" width="80" height="80" rx="8" class="array-box box-3"/>
    <text x="460" y="210" class="array-text">10</text>
    
    <rect x="520" y="170" width="80" height="80" rx="8" class="array-box box-4"/>
    <text x="560" y="210" class="array-text">23</text>
    
    <rect x="620" y="170" width="80" height="80" rx="8" class="array-box box-5"/>
    <text x="660" y="210" class="array-text">3</text>
    
    <rect x="720" y="170" width="80" height="80" rx="8" class="array-box box-6"/>
    <text x="760" y="210" class="array-text">1</text>
    
    <rect x="820" y="170" width="80" height="80" rx="8" class="array-box box-7"/>
    <text x="860" y="210" class="array-text">0</text>
    
    <rect x="920" y="170" width="80" height="80" rx="8" class="array-box box-8"/>
    <text x="960" y="210" class="array-text">20</text>
  </g>
  
  <!-- 移除箭头组 (跟随窗口左边移动) -->
  <g class="remove-arrow-group">
    <path d="M 160 260 L 160 290" class="remove-arrow"/>
    <text x="160" y="310" class="sum-text remove-label" style="font-size: 14px; fill: #ff5252; text-anchor: middle;">-移出</text>
  </g>
  
  <!-- 添加箭头组 (跟随新元素移动) -->
  <g class="add-arrow-group">
    <path d="M 160 260 L 160 290" class="add-arrow"/>
    <text x="160" y="310" class="sum-text add-label" style="font-size: 14px; fill: #4caf50; text-anchor: middle;">+加入</text>
  </g>
  
  <!-- 当前窗口和 -->
  <g transform="translate(1020, 170)">
    <rect x="0" y="0" width="150" height="80" class="sum-box"/>
    <text x="75" y="30" class="sum-text" style="font-size: 14px;">窗口和</text>
    <!-- 使用单独的text元素,通过opacity控制显示 -->
    <text x="75" y="60" class="sum-value sum0">17</text>
    <text x="75" y="60" class="sum-value sum1">39</text>
    <text x="75" y="60" class="sum-value sum2">38</text>
    <text x="75" y="60" class="sum-value sum3">37</text>
    <text x="75" y="60" class="sum-value sum4">27</text>
    <text x="75" y="60" class="sum-value sum5">24</text>
  </g>
  
  <!-- 当前最大和 -->
  <g transform="translate(1020, 270)">
    <rect x="0" y="0" width="150" height="60" class="max-box"/>
    <text x="75" y="25" style="font-size: 14px; fill: #2e7d32; text-anchor: middle; font-weight: 600;">最大和</text>
    <text x="75" y="50" class="max-text">39</text>
  </g>
  
  <!-- 操作步骤说明 -->
  <g transform="translate(100, 360)">
    <rect x="0" y="0" width="900" height="40" rx="8" fill="#ffffff" stroke="#e0e0e0" stroke-width="2"/>
    <text x="20" y="25" class="step-text step0">初始化: 窗口[0-3] = 1+4+2+10 = 17, maxSum = 17</text>
    <text x="20" y="25" class="step-text step1">步骤1: 移出1, 加入23 → 17-1+23 = 39 ✨ 更新最大值!</text>
    <text x="20" y="25" class="step-text step2">步骤2: 移出4, 加入3 → 39-4+3 = 38</text>
    <text x="20" y="25" class="step-text step3">步骤3: 移出2, 加入1 → 38-2+1 = 37</text>
    <text x="20" y="25" class="step-text step4">步骤4: 移出10, 加入0 → 37-10+0 = 27</text>
    <text x="20" y="25" class="step-text step5">步骤5: 移出23, 加入20 → 27-23+20 = 24</text>
  </g>
  
  <!-- 图例 -->
  <g transform="translate(100, 420)">
    <rect x="0" y="0" width="900" height="60" class="legend-box"/>
    <text x="20" y="25" class="legend-text" style="font-weight: 600;">图例说明:</text>
    
    <rect x="120" y="10" width="40" height="25" rx="4" fill="#c8e6c9" stroke="#4caf50" stroke-width="2"/>
    <text x="170" y="27" class="legend-text">窗口内元素</text>
    
    <rect x="280" y="10" width="40" height="25" rx="4" fill="#fff9c4" stroke="#fbc02d" stroke-width="2"/>
    <text x="330" y="27" class="legend-text">新加入</text>
    
    <rect x="410" y="10" width="40" height="25" rx="4" fill="#ffccbc" stroke="#ff5722" stroke-width="2"/>
    <text x="460" y="27" class="legend-text">移出</text>
    
    <rect x="530" y="10" width="40" height="25" rx="4" fill="#e0e0e0" stroke="#9e9e9e" stroke-width="2"/>
    <text x="580" y="27" class="legend-text">已处理</text>
    
    <rect x="660" y="10" width="60" height="25" rx="4" fill="#bbdefb" stroke="#2196f3" stroke-width="2" stroke-dasharray="3,3"/>
    <text x="730" y="27" class="legend-text">固定窗口</text>
  </g>
  
  <!-- 代码示例框 -->
  <g transform="translate(100, 500)">
    <rect x="0" y="0" width="900" height="180" rx="8" fill="#f5f5f5" stroke="#e0e0e0" stroke-width="2"/>
    <text x="20" y="25" class="code-text" fill="#757575">// 计算第一个窗口的和</text>
    <text x="20" y="45" class="code-text">let windowSum = 0;</text>
    <text x="20" y="65" class="code-text" fill="#d32f2f">for</text>
    <text x="55" y="65" class="code-text">(let i = 0; i &lt; k; i++) windowSum += nums[i];</text>
    <text x="20" y="85" class="code-text">let maxSum = windowSum;</text>
    <text x="250" y="85" class="code-text" fill="#757575">// 1+4+2+10 = 17</text>
    
    <text x="20" y="110" class="code-text" fill="#757575">// 滑动窗口: 移出左边,加入右边</text>
    <text x="20" y="130" class="code-text" fill="#d32f2f">for</text>
    <text x="55" y="130" class="code-text">(let i = k; i &lt; nums.length; i++) {</text>
    
    <text x="40" y="150" class="code-text">windowSum = windowSum - nums[i - k] + nums[i];</text>
    <text x="40" y="165" class="code-text">maxSum = Math.max(maxSum, windowSum);</text>
    
    <text x="20" y="180" class="code-text">}</text>
  </g>
  
  <!-- 核心思想 -->
  <g transform="translate(1020, 360)">
    <rect x="0" y="0" width="150" height="140" rx="8" fill="#e8f5e9" stroke="#4caf50" stroke-width="2"/>
    <text x="75" y="25" style="font-size: 14px; fill: #2e7d32; text-anchor: middle; font-weight: 600;">窗口变化</text>
    <text x="75" y="50" style="font-size: 11px; fill: #424242; text-anchor: middle;">[1,4,2,10]=17</text>
    <text x="75" y="68" style="font-size: 11px; fill: #424242; text-anchor: middle;">[4,2,10,23]=39✨</text>
    <text x="75" y="86" style="font-size: 11px; fill: #424242; text-anchor: middle;">[2,10,23,3]=38</text>
    <text x="75" y="104" style="font-size: 11px; fill: #424242; text-anchor: middle;">[10,23,3,1]=37</text>
    <text x="75" y="122" style="font-size: 11px; fill: #424242; text-anchor: middle;">[23,3,1,0]=27</text>
  </g>
</svg>